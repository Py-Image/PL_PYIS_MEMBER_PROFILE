!function(a,b){"object"==typeof exports&&"object"==typeof module?module.exports=b(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],b):"object"==typeof exports?exports.cropit=b(require("jquery")):a.cropit=b(a.jQuery)}(this,function(a){return function(a){function b(d){if(c[d])return c[d].exports;var e=c[d]={exports:{},id:d,loaded:!1};return a[d].call(e.exports,e,e.exports,b),e.loaded=!0,e.exports}var c={};return b.m=a,b.c=c,b.p="",b(0)}([function(a,b,c){function d(a){return a&&a.__esModule?a:{"default":a}}var e=Array.prototype.slice,f=c(1),g=d(f),h=c(2),i=d(h),j=c(4),k=c(6),l=function(a,b){return a.each(function(){var a=g["default"].data(this,j.PLUGIN_KEY);a&&b(a)})},m=function(a,b,c){var d=a.first().data(j.PLUGIN_KEY);return d&&g["default"].isFunction(d[b])?d[b](c):null},n={init:function(a){return this.each(function(){if(!g["default"].data(this,j.PLUGIN_KEY)){var b=new i["default"](g["default"],this,a);g["default"].data(this,j.PLUGIN_KEY,b)}})},destroy:function(){return this.each(function(){g["default"].removeData(this,j.PLUGIN_KEY)})},isZoomable:function(){return m(this,"isZoomable")},"export":function(a){return m(this,"getCroppedImageData",a)}},o=function(a,b){return l(a,function(a){a[b]()})},p=function(a,b,c){if((0,k.exists)(c))return l(a,function(a){a[b]=c});var d=a.first().data(j.PLUGIN_KEY);return d[b]};g["default"].fn.cropit=function(a){return n[a]?n[a].apply(this,Array.prototype.slice.call(arguments,1)):["imageState","imageSrc","offset","previewSize","imageSize","zoom","initialZoom","exportZoom","minZoom","maxZoom"].indexOf(a)>=0?p.apply(void 0,[this].concat(e.call(arguments))):["rotateCW","rotateCCW","disable","reenable"].indexOf(a)>=0?o.apply(void 0,[this].concat(e.call(arguments))):n.init.apply(this,arguments)}},function(b,c){b.exports=a},function(a,b,c){function d(a){return a&&a.__esModule?a:{"default":a}}function e(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var f=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),g=c(1),h=d(g),i=c(3),j=d(i),k=c(4),l=c(5),m=c(6),n=function(){function a(b,c,d){e(this,a),this.$el=(0,h["default"])(c);var f=(0,l.loadDefaults)(this.$el);this.options=h["default"].extend({},f,d),this.init()}return f(a,[{key:"init",value:function(){var a=this;this.image=new Image,this.preImage=new Image,this.image.onload=this.onImageLoaded.bind(this),this.preImage.onload=this.onPreImageLoaded.bind(this),this.image.onerror=this.preImage.onerror=function(){a.onImageError.call(a,k.ERRORS.IMAGE_FAILED_TO_LOAD)},this.$preview=this.options.$preview.css("position","relative"),this.$fileInput=this.options.$fileInput.attr({accept:"image/*"}),this.$zoomSlider=this.options.$zoomSlider.attr({min:0,max:1,step:.01}),this.previewSize={width:this.options.width||this.$preview.innerWidth(),height:this.options.height||this.$preview.innerHeight()},this.$image=(0,h["default"])("<img />").addClass(k.CLASS_NAMES.PREVIEW_IMAGE).attr("alt","").css({transformOrigin:"top left",webkitTransformOrigin:"top left",willChange:"transform"}),this.$imageContainer=(0,h["default"])("<div />").addClass(k.CLASS_NAMES.PREVIEW_IMAGE_CONTAINER).css({position:"absolute",overflow:"hidden",left:0,top:0,width:"100%",height:"100%"}).append(this.$image),this.$preview.append(this.$imageContainer),this.options.imageBackground&&(h["default"].isArray(this.options.imageBackgroundBorderWidth)?this.bgBorderWidthArray=this.options.imageBackgroundBorderWidth:this.bgBorderWidthArray=[0,1,2,3].map(function(){return a.options.imageBackgroundBorderWidth}),this.$bg=(0,h["default"])("<img />").addClass(k.CLASS_NAMES.PREVIEW_BACKGROUND).attr("alt","").css({position:"relative",left:this.bgBorderWidthArray[3],top:this.bgBorderWidthArray[0],transformOrigin:"top left",webkitTransformOrigin:"top left",willChange:"transform"}),this.$bgContainer=(0,h["default"])("<div />").addClass(k.CLASS_NAMES.PREVIEW_BACKGROUND_CONTAINER).css({position:"absolute",zIndex:0,top:-this.bgBorderWidthArray[0],right:-this.bgBorderWidthArray[1],bottom:-this.bgBorderWidthArray[2],left:-this.bgBorderWidthArray[3]}).append(this.$bg),this.bgBorderWidthArray[0]>0&&this.$bgContainer.css("overflow","hidden"),this.$preview.prepend(this.$bgContainer)),this.initialZoom=this.options.initialZoom,this.imageLoaded=!1,this.moveContinue=!1,this.zoomer=new j["default"],this.options.allowDragNDrop&&h["default"].event.props.push("dataTransfer"),this.bindListeners(),this.options.imageState&&this.options.imageState.src&&this.loadImage(this.options.imageState.src)}},{key:"bindListeners",value:function(){this.$fileInput.on("change.cropit",this.onFileChange.bind(this)),this.$imageContainer.on(k.EVENTS.PREVIEW,this.onPreviewEvent.bind(this)),this.$zoomSlider.on(k.EVENTS.ZOOM_INPUT,this.onZoomSliderChange.bind(this)),this.options.allowDragNDrop&&(this.$imageContainer.on("dragover.cropit dragleave.cropit",this.onDragOver.bind(this)),this.$imageContainer.on("drop.cropit",this.onDrop.bind(this)))}},{key:"unbindListeners",value:function(){this.$fileInput.off("change.cropit"),this.$imageContainer.off(k.EVENTS.PREVIEW),this.$imageContainer.off("dragover.cropit dragleave.cropit drop.cropit"),this.$zoomSlider.off(k.EVENTS.ZOOM_INPUT)}},{key:"onFileChange",value:function(a){this.options.onFileChange(a),this.$fileInput.get(0).files&&this.loadFile(this.$fileInput.get(0).files[0])}},{key:"loadFile",value:function(a){var b=new FileReader;a&&a.type.match("image")?(b.readAsDataURL(a),b.onload=this.onFileReaderLoaded.bind(this),b.onerror=this.onFileReaderError.bind(this)):a&&this.onFileReaderError()}},{key:"onFileReaderLoaded",value:function(a){this.loadImage(a.target.result)}},{key:"onFileReaderError",value:function(){this.options.onFileReaderError()}},{key:"onDragOver",value:function(a){a.preventDefault(),a.dataTransfer.dropEffect="copy",this.$preview.toggleClass(k.CLASS_NAMES.DRAG_HOVERED,"dragover"===a.type)}},{key:"onDrop",value:function(a){var b=this;a.preventDefault(),a.stopPropagation();var c=Array.prototype.slice.call(a.dataTransfer.files,0);c.some(function(a){return a.type.match("image")?(b.loadFile(a),!0):!1}),this.$preview.removeClass(k.CLASS_NAMES.DRAG_HOVERED)}},{key:"loadImage",value:function(a){var b=this;if(a)if(this.options.onImageLoading(),this.setImageLoadingClass(),0===a.indexOf("data"))this.preImage.src=a;else{var c=new XMLHttpRequest;c.onload=function(a){return a.target.status>=300?void b.onImageError.call(b,k.ERRORS.IMAGE_FAILED_TO_LOAD):void b.loadFile(a.target.response)},c.open("GET",a),c.responseType="blob",c.send()}}},{key:"onPreImageLoaded",value:function(){return this.shouldRejectImage({imageWidth:this.preImage.width,imageHeight:this.preImage.height,previewSize:this.previewSize,maxZoom:this.options.maxZoom,exportZoom:this.options.exportZoom,smallImage:this.options.smallImage})?(this.onImageError(k.ERRORS.SMALL_IMAGE),void(this.image.src&&this.setImageLoadedClass())):void(this.image.src=this.preImage.src)}},{key:"onImageLoaded",value:function(){this.rotation=0,this.setupZoomer(this.options.imageState&&this.options.imageState.zoom||this._initialZoom),this.options.imageState&&this.options.imageState.offset?this.offset=this.options.imageState.offset:this.centerImage(),this.options.imageState={},this.$image.attr("src",this.image.src),this.options.imageBackground&&this.$bg.attr("src",this.image.src),this.setImageLoadedClass(),this.imageLoaded=!0,this.options.onImageLoaded()}},{key:"onImageError",value:function(){this.options.onImageError.apply(this,arguments),this.removeImageLoadingClass()}},{key:"setImageLoadingClass",value:function(){this.$preview.removeClass(k.CLASS_NAMES.IMAGE_LOADED).addClass(k.CLASS_NAMES.IMAGE_LOADING)}},{key:"setImageLoadedClass",value:function(){this.$preview.removeClass(k.CLASS_NAMES.IMAGE_LOADING).addClass(k.CLASS_NAMES.IMAGE_LOADED)}},{key:"removeImageLoadingClass",value:function(){this.$preview.removeClass(k.CLASS_NAMES.IMAGE_LOADING)}},{key:"getEventPosition",value:function(a){return a.originalEvent&&a.originalEvent.touches&&a.originalEvent.touches[0]&&(a=a.originalEvent.touches[0]),a.clientX&&a.clientY?{x:a.clientX,y:a.clientY}:void 0}},{key:"onPreviewEvent",value:function(a){return this.imageLoaded?(this.moveContinue=!1,this.$imageContainer.off(k.EVENTS.PREVIEW_MOVE),"mousedown"===a.type||"touchstart"===a.type?(this.origin=this.getEventPosition(a),this.moveContinue=!0,this.$imageContainer.on(k.EVENTS.PREVIEW_MOVE,this.onMove.bind(this))):(0,h["default"])(document.body).focus(),a.stopPropagation(),!1):void 0}},{key:"onMove",value:function(a){var b=this.getEventPosition(a);return this.moveContinue&&b&&(this.offset={x:this.offset.x+b.x-this.origin.x,y:this.offset.y+b.y-this.origin.y}),this.origin=b,a.stopPropagation(),!1}},{key:"fixOffset",value:function(a){if(!this.imageLoaded)return a;var b={x:a.x,y:a.y};return this.options.freeMove||(this.imageWidth*this.zoom>=this.previewSize.width?b.x=Math.min(0,Math.max(b.x,this.previewSize.width-this.imageWidth*this.zoom)):b.x=Math.max(0,Math.min(b.x,this.previewSize.width-this.imageWidth*this.zoom)),this.imageHeight*this.zoom>=this.previewSize.height?b.y=Math.min(0,Math.max(b.y,this.previewSize.height-this.imageHeight*this.zoom)):b.y=Math.max(0,Math.min(b.y,this.previewSize.height-this.imageHeight*this.zoom))),b.x=(0,m.round)(b.x),b.y=(0,m.round)(b.y),b}},{key:"centerImage",value:function(){this.image.width&&this.image.height&&this.zoom&&(this.offset={x:(this.previewSize.width-this.imageWidth*this.zoom)/2,y:(this.previewSize.height-this.imageHeight*this.zoom)/2})}},{key:"onZoomSliderChange",value:function(){if(this.imageLoaded){this.zoomSliderPos=Number(this.$zoomSlider.val());var a=this.zoomer.getZoom(this.zoomSliderPos);a!==this.zoom&&(this.zoom=a)}}},{key:"enableZoomSlider",value:function(){this.$zoomSlider.removeAttr("disabled"),this.options.onZoomEnabled()}},{key:"disableZoomSlider",value:function(){this.$zoomSlider.attr("disabled",!0),this.options.onZoomDisabled()}},{key:"setupZoomer",value:function(a){this.zoomer.setup({imageSize:this.imageSize,previewSize:this.previewSize,exportZoom:this.options.exportZoom,maxZoom:this.options.maxZoom,minZoom:this.options.minZoom,smallImage:this.options.smallImage}),this.zoom=(0,m.exists)(a)?a:this._zoom,this.isZoomable()?this.enableZoomSlider():this.disableZoomSlider()}},{key:"fixZoom",value:function(a){return this.zoomer.fixZoom(a)}},{key:"isZoomable",value:function(){return this.zoomer.isZoomable()}},{key:"renderImage",value:function(){var a="\n      translate("+this.rotatedOffset.x+"px, "+this.rotatedOffset.y+"px)\n      scale("+this.zoom+")\n      rotate("+this.rotation+"deg)";this.$image.css({transform:a,webkitTransform:a}),this.options.imageBackground&&this.$bg.css({transform:a,webkitTransform:a})}},{key:"rotateCW",value:function(){this.shouldRejectImage({imageWidth:this.image.height,imageHeight:this.image.width,previewSize:this.previewSize,maxZoom:this.options.maxZoom,exportZoom:this.options.exportZoom,smallImage:this.options.smallImage})?this.rotation=(this.rotation+180)%360:this.rotation=(this.rotation+90)%360}},{key:"rotateCCW",value:function(){this.shouldRejectImage({imageWidth:this.image.height,imageHeight:this.image.width,previewSize:this.previewSize,maxZoom:this.options.maxZoom,exportZoom:this.options.exportZoom,smallImage:this.options.smallImage})?this.rotation=(this.rotation+180)%360:this.rotation=(this.rotation+270)%360}},{key:"shouldRejectImage",value:function(a){var b=a.imageWidth,c=a.imageHeight,d=a.previewSize,e=a.maxZoom,f=a.exportZoom,g=a.smallImage;return"reject"!==g?!1:b*e<d.width*f||c*e<d.height*f}},{key:"getCroppedImageData",value:function(a){if(this.image.src){var b={type:"image/png",quality:.75,originalSize:!1,fillBg:"#fff"};a=h["default"].extend({},b,a);var c=a.originalSize?1/this.zoom:this.options.exportZoom,d={width:this.zoom*c*this.image.width,height:this.zoom*c*this.image.height},e=(0,h["default"])("<canvas />").attr({width:this.previewSize.width*c,height:this.previewSize.height*c}).get(0),f=e.getContext("2d");return"image/jpeg"===a.type&&(f.fillStyle=a.fillBg,f.fillRect(0,0,e.width,e.height)),f.translate(this.rotatedOffset.x*c,this.rotatedOffset.y*c),f.rotate(this.rotation*Math.PI/180),f.drawImage(this.image,0,0,d.width,d.height),e.toDataURL(a.type,a.quality)}}},{key:"disable",value:function(){this.unbindListeners(),this.disableZoomSlider(),this.$el.addClass(k.CLASS_NAMES.DISABLED)}},{key:"reenable",value:function(){this.bindListeners(),this.enableZoomSlider(),this.$el.removeClass(k.CLASS_NAMES.DISABLED)}},{key:"$",value:function(a){return this.$el?this.$el.find(a):null}},{key:"offset",set:function(a){a&&(0,m.exists)(a.x)&&(0,m.exists)(a.y)&&(this._offset=this.fixOffset(a),this.renderImage(),this.options.onOffsetChange(a))},get:function(){return this._offset}},{key:"zoom",set:function(a){if(a=this.fixZoom(a),this.imageLoaded){var b=this.zoom,c=this.previewSize.width/2-(this.previewSize.width/2-this.offset.x)*a/b,d=this.previewSize.height/2-(this.previewSize.height/2-this.offset.y)*a/b;this._zoom=a,this.offset={x:c,y:d}}else this._zoom=a;this.zoomSliderPos=this.zoomer.getSliderPos(this.zoom),this.$zoomSlider.val(this.zoomSliderPos),this.options.onZoomChange(a)},get:function(){return this._zoom}},{key:"rotatedOffset",get:function(){return{x:this.offset.x+(90===this.rotation?this.image.height*this.zoom:0)+(180===this.rotation?this.image.width*this.zoom:0),y:this.offset.y+(180===this.rotation?this.image.height*this.zoom:0)+(270===this.rotation?this.image.width*this.zoom:0)}}},{key:"rotation",set:function(a){this._rotation=a,this.imageLoaded&&this.setupZoomer()},get:function(){return this._rotation}},{key:"imageState",get:function(){return{src:this.image.src,offset:this.offset,zoom:this.zoom}}},{key:"imageSrc",get:function(){return this.image.src},set:function(a){this.loadImage(a)}},{key:"imageWidth",get:function(){return this.rotation%180===0?this.image.width:this.image.height}},{key:"imageHeight",get:function(){return this.rotation%180===0?this.image.height:this.image.width}},{key:"imageSize",get:function(){return{width:this.imageWidth,height:this.imageHeight}}},{key:"initialZoom",get:function(){return this.options.initialZoom},set:function(a){this.options.initialZoom=a,"min"===a?this._initialZoom=0:"image"===a?this._initialZoom=1:this._initialZoom=0}},{key:"exportZoom",get:function(){return this.options.exportZoom},set:function(a){this.options.exportZoom=a,this.setupZoomer()}},{key:"minZoom",get:function(){return this.options.minZoom},set:function(a){this.options.minZoom=a,this.setupZoomer()}},{key:"maxZoom",get:function(){return this.options.maxZoom},set:function(a){this.options.maxZoom=a,this.setupZoomer()}},{key:"previewSize",get:function(){return this._previewSize},set:function(a){!a||a.width<=0||a.height<=0||(this._previewSize={width:a.width,height:a.height},this.$preview.innerWidth(this.previewSize.width).innerHeight(this.previewSize.height),this.imageLoaded&&this.setupZoomer())}}]),a}();b["default"]=n,a.exports=b["default"]},function(a,b){function c(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(b,"__esModule",{value:!0});var d=function(){function a(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),e=function(){function a(){c(this,a),this.minZoom=this.maxZoom=1}return d(a,[{key:"setup",value:function(a){var b=a.imageSize,c=a.previewSize,d=a.exportZoom,e=a.maxZoom,f=a.minZoom,g=a.smallImage,h=c.width/b.width,i=c.height/b.height;"fit"===f?this.minZoom=Math.min(h,i):this.minZoom=Math.max(h,i),"allow"===g&&(this.minZoom=Math.min(this.minZoom,1)),this.maxZoom=Math.max(this.minZoom,e/d)}},{key:"getZoom",value:function(a){return this.minZoom&&this.maxZoom?a*(this.maxZoom-this.minZoom)+this.minZoom:null}},{key:"getSliderPos",value:function(a){return this.minZoom&&this.maxZoom?this.minZoom===this.maxZoom?0:(a-this.minZoom)/(this.maxZoom-this.minZoom):null}},{key:"isZoomable",value:function(){return this.minZoom&&this.maxZoom?this.minZoom!==this.maxZoom:null}},{key:"fixZoom",value:function(a){return Math.max(this.minZoom,Math.min(this.maxZoom,a))}}]),a}();b["default"]=e,a.exports=b["default"]},function(a,b){Object.defineProperty(b,"__esModule",{value:!0});var c="cropit";b.PLUGIN_KEY=c;var d={PREVIEW:"cropit-preview",PREVIEW_IMAGE_CONTAINER:"cropit-preview-image-container",PREVIEW_IMAGE:"cropit-preview-image",PREVIEW_BACKGROUND_CONTAINER:"cropit-preview-background-container",PREVIEW_BACKGROUND:"cropit-preview-background",FILE_INPUT:"cropit-image-input",ZOOM_SLIDER:"cropit-image-zoom-input",DRAG_HOVERED:"cropit-drag-hovered",IMAGE_LOADING:"cropit-image-loading",IMAGE_LOADED:"cropit-image-loaded",DISABLED:"cropit-disabled"};b.CLASS_NAMES=d;var e={IMAGE_FAILED_TO_LOAD:{code:0,message:"Image failed to load."},SMALL_IMAGE:{code:1,message:"Image is too small."}};b.ERRORS=e;var f=function(a){return a.map(function(a){return""+a+".cropit"}).join(" ")},g={PREVIEW:f(["mousedown","mouseup","mouseleave","touchstart","touchend","touchcancel","touchleave"]),PREVIEW_MOVE:f(["mousemove","touchmove"]),ZOOM_INPUT:f(["mousemove","touchmove","change"])};b.EVENTS=g},function(a,b,c){Object.defineProperty(b,"__esModule",{value:!0});var d=c(4),e={elements:[{name:"$preview",description:"The HTML element that displays image preview.",defaultSelector:"."+d.CLASS_NAMES.PREVIEW},{name:"$fileInput",description:"File input element.",defaultSelector:"input."+d.CLASS_NAMES.FILE_INPUT},{name:"$zoomSlider",description:"Range input element that controls image zoom.",defaultSelector:"input."+d.CLASS_NAMES.ZOOM_SLIDER}].map(function(a){return a.type="jQuery element",a["default"]="$imageCropper.find('"+a.defaultSelector+"')",a}),values:[{name:"width",type:"number",description:"Width of image preview in pixels. If set, it will override the CSS property.","default":null},{name:"height",type:"number",description:"Height of image preview in pixels. If set, it will override the CSS property.","default":null},{name:"imageBackground",type:"boolean",description:"Whether or not to display the background image beyond the preview area.","default":!1},{name:"imageBackgroundBorderWidth",type:"array or number",description:"Width of background image border in pixels.\n        The four array elements specify the width of background image width on the top, right, bottom, left side respectively.\n        The background image beyond the width will be hidden.\n        If specified as a number, border with uniform width on all sides will be applied.","default":[0,0,0,0]},{name:"exportZoom",type:"number",description:"The ratio between the desired image size to export and the preview size.\n        For example, if the preview size is `300px * 200px`, and `exportZoom = 2`, then\n        the exported image size will be `600px * 400px`.\n        This also affects the maximum zoom level, since the exported image cannot be zoomed to larger than its original size.","default":1},{name:"allowDragNDrop",type:"boolean",description:"When set to true, you can load an image by dragging it from local file browser onto the preview area.","default":!0},{name:"minZoom",type:"string",description:"This options decides the minimal zoom level of the image.\n        If set to `'fill'`, the image has to fill the preview area, i.e. both width and height must not go smaller than the preview area.\n        If set to `'fit'`, the image can shrink further to fit the preview area, i.e. at least one of its edges must not go smaller than the preview area.","default":"fill"},{name:"maxZoom",type:"number",description:"Determines how big the image can be zoomed. E.g. if set to 1.5, the image can be zoomed to 150% of its original size.","default":1},{name:"initialZoom",type:"string",description:"Determines the zoom when an image is loaded.\n        When set to `'min'`, image is zoomed to the smallest when loaded.\n        When set to `'image'`, image is zoomed to 100% when loaded.","default":"min"},{name:"freeMove",type:"boolean",description:"When set to true, you can freely move the image instead of being bound to the container borders","default":!1},{name:"smallImage",type:"string",description:"When set to `'reject'`, `onImageError` would be called when cropit loads an image that is smaller than the container.\n        When set to `'allow'`, images smaller than the container can be zoomed down to its original size, overiding `minZoom` option.\n        When set to `'stretch'`, the minimum zoom of small images would follow `minZoom` option.","default":"reject"}],callbacks:[{name:"onFileChange",description:"Called when user selects a file in the select file input.",params:[{name:"event",type:"object",description:"File change event object"}]},{name:"onFileReaderError",description:"Called when `FileReader` encounters an error while loading the image file."},{name:"onImageLoading",description:"Called when image starts to be loaded."},{name:"onImageLoaded",description:"Called when image is loaded."},{name:"onImageError",description:"Called when image cannot be loaded.",params:[{name:"error",type:"object",description:"Error object."},{name:"error.code",type:"number",description:"Error code. `0` means generic image loading failure. `1` means image is too small."},{name:"error.message",type:"string",description:"A message explaining the error."}]},{name:"onZoomEnabled",description:"Called when image the zoom slider is enabled."},{name:"onZoomDisabled",description:"Called when image the zoom slider is disabled."},{name:"onZoomChange",description:"Called when zoom changes.",params:[{name:"zoom",type:"number",description:"New zoom."}]},{name:"onOffsetChange",description:"Called when image offset changes.",params:[{name:"offset",type:"object",description:"New offset, with `x` and `y` values."}]}].map(function(a){return a.type="function",a})},f=function(a){var b={};return a&&e.elements.forEach(function(c){b[c.name]=a.find(c.defaultSelector)}),e.values.forEach(function(a){b[a.name]=a["default"]}),e.callbacks.forEach(function(a){b[a.name]=function(){}}),b};b.loadDefaults=f,b["default"]=e},function(a,b){Object.defineProperty(b,"__esModule",{value:!0});var c=function(a){return"undefined"!=typeof a};b.exists=c;var d=function(a){return+(Math.round(100*a)+"e-2")};b.round=d}])}),!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.pica=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";b.exports=function(){return document.createElement("canvas")}},{}],2:[function(a,b,c){"use strict";var d=1;b.exports=function(){return d++}},{}],3:[function(a,b,c){"use strict";function d(a){this.create=a,this.available=[],this.acquired={},this.lastId=1,this.timeoutId=0}var e=2e3,f=500;d.prototype.acquire=function(){var a,b=this;return 0!==this.available.length?a=this.available.pop():(a=this.create(),a.id=this.lastId++,a.release=function(){b.release(a)}),this.acquired[a.id]=a,a},d.prototype.release=function(a){delete this.acquired[a.id],a.lastUsed=Date.now(),this.available.push(a),0===this.timeoutId&&(this.timeoutId=setTimeout(this.gc.bind(this),f))},d.prototype.gc=function(){var a=Date.now();this.available=this.available.filter(function(b){return a-b.lastUsed>e?(b.destroy(),!1):!0}),0!==this.available.length?this.timeoutId=setTimeout(this.gc.bind(this),f):this.timeoutId=0},b.exports=d},{}],4:[function(a,b,c){"use strict";function d(a){return 0>a?0:a>255?255:a}function e(a){return Math.round(a*((1<<k)-1))}function f(a,b,c,d,f){var g,h,i,j,k,m,n,o,p,q,r,s,t,u,v,w,x,y=l[a].filter,z=1/d,A=Math.min(1,d),B=l[a].win/A,C=Math.floor(2*(B+1)),D=new Int16Array((C+2)*c),E=0;for(g=0;c>g;g++){for(h=(g+.5)*z+f,i=Math.max(0,Math.floor(h-B)),j=Math.min(b-1,Math.ceil(h+B)),k=j-i+1,m=new Float32Array(k),n=new Int16Array(k),o=0,p=i,q=0;j>=p;p++,q++)r=y((p+.5-h)*A),o+=r,m[q]=r;for(s=0,q=0;q<m.length;q++)t=m[q]/o,s+=t,n[q]=e(t);for(n[c>>1]+=e(1-s),u=0;u<n.length&&0===n[u];)u++;if(u<n.length){for(v=n.length-1;v>0&&0===n[v];)v--;w=i+u,x=v-u+1,D[E++]=w,D[E++]=x,D.set(n.subarray(u,v+1),E),E+=x}else D[E++]=0,D[E++]=0}return D}function g(a,b,c,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s=0,t=0;for(p=0;e>p;p++){for(l=0,q=0;f>q;q++){for(m=g[l++],n=g[l++],o=s+4*m|0,h=i=j=k=0;n>0;n--)r=g[l++],k=k+r*a[o+3]|0,j=j+r*a[o+2]|0,i=i+r*a[o+1]|0,h=h+r*a[o]|0,o=o+4|0;b[t+3]=d(k+8192>>14),b[t+2]=d(j+8192>>14),b[t+1]=d(i+8192>>14),b[t]=d(h+8192>>14),t=t+4*e|0}t=4*(p+1)|0,s=(p+1)*c*4|0}}function h(a,b,c,e,f,g){var h,i,j,k,l,m,n,o,p,q,r,s=0,t=0;for(p=0;e>p;p++){for(l=0,q=0;f>q;q++){for(m=g[l++],n=g[l++],o=s+4*m|0,h=i=j=k=0;n>0;n--)r=g[l++],k=k+r*a[o+3]|0,j=j+r*a[o+2]|0,i=i+r*a[o+1]|0,h=h+r*a[o]|0,o=o+4|0;b[t+3]=d(k+8192>>14),b[t+2]=d(j+8192>>14),b[t+1]=d(i+8192>>14),b[t]=d(h+8192>>14),t=t+4*e|0}t=4*(p+1)|0,s=(p+1)*c*4|0}}function i(a,b,c){for(var d=3,e=b*c*4|0;e>d;)a[d]=255,d=d+4|0}function j(a){var b=a.src,c=a.width,d=a.height,e=a.toWidth,j=a.toHeight,k=a.scaleX||a.toWidth/a.width,l=a.scaleY||a.toHeight/a.height,m=a.offsetX||0,n=a.offsetY||0,o=a.dest||new Uint8Array(e*j*4),p="undefined"==typeof a.quality?3:a.quality,q=a.alpha||!1;if(1>c||1>d||1>e||1>j)return[];var r=f(p,c,e,k,m),s=f(p,d,j,l,n),t=new Uint8Array(e*d*4);return g(b,t,c,d,e,r),h(t,o,d,e,j,s),q||i(o,e,j),o}var k=14,l=[{win:.5,filter:function(a){return a>=-.5&&.5>a?1:0}},{win:1,filter:function(a){if(-1>=a||a>=1)return 0;if(a>-1.1920929e-7&&1.1920929e-7>a)return 1;var b=a*Math.PI;return Math.sin(b)/b*(.54+.46*Math.cos(b/1))}},{win:2,filter:function(a){if(-2>=a||a>=2)return 0;if(a>-1.1920929e-7&&1.1920929e-7>a)return 1;var b=a*Math.PI;return Math.sin(b)/b*Math.sin(b/2)/(b/2)}},{win:3,filter:function(a){if(-3>=a||a>=3)return 0;if(a>-1.1920929e-7&&1.1920929e-7>a)return 1;var b=a*Math.PI;return Math.sin(b)/b*Math.sin(b/3)/(b/3)}}];b.exports=j},{}],5:[function(a,b,c){"use strict";function d(a,b,c){for(var d,e,f,g,h,i=b*c,j=new Uint16Array(i),k=0;i>k;k++)d=a[4*k],e=a[4*k+1],f=a[4*k+2],h=d>=e&&d>=f?d:e>=f&&e>=d?e:f,g=e>=d&&f>=d?d:f>=e&&d>=e?e:f,j[k]=257*(h+g)>>1;return j}function e(a,b,c,e,g,h){var i,j,k,l,m,n,o,p,q,r,s,t,u;if(!(0===e||.5>g)){g>2&&(g=2);var v=d(a,b,c),w=new Uint16Array(v);f(w,b,c,g);for(var x=e/100*4096+.5|0,y=257*h|0,z=b*c,A=0;z>A;A++)t=2*(v[A]-w[A]),Math.abs(t)>=y&&(u=4*A,i=a[u],j=a[u+1],k=a[u+2],p=i>=j&&i>=k?i:j>=i&&j>=k?j:k,o=j>=i&&k>=i?i:i>=j&&k>=j?j:k,n=257*(p+o)>>1,o===p?l=m=0:(m=32767>=n?4095*(p-o)/(p+o)|0:4095*(p-o)/(510-p-o)|0,l=i===p?65535*(j-k)/(6*(p-o))|0:j===p?21845+(65535*(k-i)/(6*(p-o))|0):43690+(65535*(i-j)/(6*(p-o))|0)),n+=x*t+2048>>12,n>65535?n=65535:0>n&&(n=0),0===m?i=j=k=n>>8:(r=32767>=n?n*(4096+m)+2048>>12:n+((65535-n)*m+2048>>12),q=2*n-r>>8,r>>=8,s=l+21845&65535,i=s>=43690?q:s>=32767?q+(6*(r-q)*(43690-s)+32768>>16):s>=10922?r:q+(6*(r-q)*s+32768>>16),s=65535&l,j=s>=43690?q:s>=32767?q+(6*(r-q)*(43690-s)+32768>>16):s>=10922?r:q+(6*(r-q)*s+32768>>16),s=l-21845&65535,k=s>=43690?q:s>=32767?q+(6*(r-q)*(43690-s)+32768>>16):s>=10922?r:q+(6*(r-q)*s+32768>>16)),a[u]=i,a[u+1]=j,a[u+2]=k)}}var f=a("glur/mono16");b.exports=e,b.exports.lightness=d},{"glur/mono16":11}],6:[function(a,b,c){"use strict";b.exports.createRegions=function(a){var b,c,d,e,f,g,h,i=a.toWidth/a.width,j=a.toHeight/a.height,k=Math.floor(a.srcTileSize*i)-2*a.destTileBorder,l=Math.floor(a.srcTileSize*j)-2*a.destTileBorder,m=[];for(e=0;e<a.toHeight;e+=l)for(d=0;d<a.toWidth;d+=k)b=d-a.destTileBorder,0>b&&(b=0),f=d+k+a.destTileBorder-b,b+f>=a.toWidth&&(f=a.toWidth-b),c=e-a.destTileBorder,0>c&&(c=0),g=e+l+a.destTileBorder-c,c+g>=a.toHeight&&(g=a.toHeight-c),h={toX:b,toY:c,toWidth:f,toHeight:g,toInnerX:d,toInnerY:e,toInnerWidth:k,toInnerHeight:l,offsetX:b/i-Math.floor(b/i),offsetY:c/j-Math.floor(c/j),scaleX:i,scaleY:j,x:Math.floor(b/i),y:Math.floor(c/j),width:Math.ceil(f/i),height:Math.ceil(g/j)},m.push(h);return m},b.exports.eachLimit=function(a,b,c,d){0===a.length&&d();for(var e=0,f=0,g=!1,h=function(b){if(!g){if(b)return g=!0,void d(b);f++,f===a.length?d():e<a.length&&c(a[e++],h)}};b>e&&e<a.length;)c(a[e++],h)}},{}],7:[function(a,b,c){"use strict";b.exports=function(b){var c=a("./resize_array"),d=a("./unsharp");b.onmessage=function(a){var e=a.data;e.dest=new Uint8Array(e.toWidth*e.toHeight*4),c(e),e.unsharpAmount&&d(e.dest,e.toWidth,e.toHeight,e.unsharpAmount,e.unsharpRadius,e.unsharpThreshold),b.postMessage({output:e.dest},[e.dest.buffer])}}},{"./resize_array":4,"./unsharp":5}],8:[function(a,b,c){"use strict";function d(a,b,c,d){var m=b.getContext("2d",{alpha:Boolean(c.alpha)}),n=j();n.width=Math.min(k,a.width),n.height=Math.min(k,a.height);var o=n.getContext("2d",{alpha:Boolean(c.alpha)});o.globalCompositeOperation="copy";var p=g({width:a.naturalWidth||a.width,height:a.naturalHeight||a.height,srcTileSize:k,toWidth:b.width,toHeight:b.height,destTileBorder:Math.ceil(Math.max(l,2.5*c.unsharpRadius|0))});return h(p,1,function(b,d){o.drawImage(a,b.x,b.y,b.width,b.height,0,0,b.width,b.height);var g=o.getImageData(0,0,b.width,b.height),h=m.createImageData(b.toWidth,b.toHeight),i={src:g.data,dest:h.data,width:b.width,height:b.height,toWidth:b.toWidth,toHeight:b.toHeight,scaleX:b.scaleX,scaleY:b.scaleY,offsetX:b.offsetX,offsetY:b.offsetY,quality:c.quality,alpha:c.alpha,unsharpAmount:c.unsharpAmount,unsharpRadius:c.unsharpRadius,unsharpThreshold:c.unsharpThreshold};e(i),c.unsharpAmount&&f(i.dest,i.toWidth,i.toHeight,i.unsharpAmount,i.unsharpRadius,i.unsharpThreshold),m.putImageData(h,b.toX,b.toY,b.toInnerX-b.toX,b.toInnerY-b.toY,b.toInnerWidth,b.toInnerHeight),d()},d),i()}var e=a("./js/resize_array"),f=a("./js/unsharp"),g=a("./js/utils").createRegions,h=a("./js/utils").eachLimit,i=a("./js/generate_id"),j=a("./js/create_canvas"),k=1024,l=3;b.exports=d,b.exports.terminate=function(){}},{"./js/create_canvas":1,"./js/generate_id":2,"./js/resize_array":4,"./js/unsharp":5,"./js/utils":6}],9:[function(a,b,c){"use strict";function d(a,b,c,d){var e=b.getContext("2d",{alpha:Boolean(c.alpha)}),f=k();f.width=Math.min(m,a.naturalWidth||a.width),f.height=Math.min(m,a.naturalHeight||a.height);var g=f.getContext("2d",{alpha:Boolean(c.alpha)});g.globalCompositeOperation="copy";var l=h({width:a.naturalWidth||a.width,height:a.naturalHeight||a.height,srcTileSize:m,toWidth:b.width,toHeight:b.height,destTileBorder:Math.ceil(Math.max(n,2.5*c.unsharpRadius|0))}),q=navigator&&navigator.hardwareConcurrency||4,r=c._id||j();return p[r]=!0,i(l,q,function(b,d){g.drawImage(a,b.x,b.y,b.width,b.height,0,0,b.width,b.height);var f=g.getImageData(0,0,b.width,b.height),h={src:f.data,width:b.width,height:b.height,toWidth:b.toWidth,toHeight:b.toHeight,scaleX:b.scaleX,scaleY:b.scaleY,offsetX:b.offsetX,offsetY:b.offsetY,quality:c.quality,alpha:c.alpha,unsharpAmount:c.unsharpAmount,unsharpRadius:c.unsharpRadius,unsharpThreshold:c.unsharpThreshold},i=o.acquire();i.value.onmessage=function(a){var c,f,g,h,j;if(i.release(),!p[r])return void d(!0);if(a.data.err)return void d(a.data.err);if(g=e.createImageData(b.toWidth,b.toHeight),h=a.data.output,j=g.data,j.set)j.set(h);else for(c=0,f=h.length;f>c;c++)j[c]=h[c];e.putImageData(g,b.toX,b.toY,b.toInnerX-b.toX,b.toInnerY-b.toY,b.toInnerWidth,b.toInnerHeight),d()},i.value.postMessage(h,[h.src.buffer])},function(a){
p[r]&&(delete p[r],d(a))}),r}function e(a){p[a]&&delete p[a]}var f=a("webworkify"),g=a("./js/worker.js"),h=a("./js/utils").createRegions,i=a("./js/utils").eachLimit,j=a("./js/generate_id"),k=a("./js/create_canvas"),l=a("./js/pool"),m=1024,n=3,o=new l(function(){return{value:f(g),destroy:function(){this.value.terminate()}}}),p={};b.exports=d,b.exports.terminate=e},{"./js/create_canvas":1,"./js/generate_id":2,"./js/pool":3,"./js/utils":6,"./js/worker.js":7,webworkify:13}],10:[function(a,b,c){"use strict";function d(a){try{(window.console.error||window.console.log).call(window.console,a)}catch(b){}}function e(a){var b=a.getError();if(b!==a.NO_ERROR)throw new Error("gl error "+b)}function f(a){return a.getContext("webgl")||a.getContext("experimental-webgl")}function g(a,b,c){var e=a.createShader(b);return a.shaderSource(e,c),a.compileShader(e),a.getShaderParameter(e,a.COMPILE_STATUS)?e:(d("Shader compile error: "+a.getShaderInfoLog(e)+". Source: `"+c+"`"),a.deleteShader(e),null)}function h(a,b,c){var f=g(a,a.VERTEX_SHADER,t[b]),h=g(a,a.FRAGMENT_SHADER,t[c]),i=a.createProgram();return a.attachShader(i,f),a.attachShader(i,h),a.linkProgram(i),a.getProgramParameter(i,a.LINK_STATUS)||(d("Program linking error: "+a.getProgramInfoLog(i)),a.deleteProgram(i)),e(a),i}function i(a,b,c,d,f){var g=a.getAttribLocation(b,c);a.bindBuffer(a.ARRAY_BUFFER,a.createBuffer()),a.bufferData(a.ARRAY_BUFFER,new Float32Array(d),a.STATIC_DRAW),a.enableVertexAttribArray(g),a.vertexAttribPointer(g,f.elementSize,a.FLOAT,!1,0,0),e(a)}function j(a,b,c){var d=a.createTexture();return a.activeTexture(a.TEXTURE0+b),a.bindTexture(a.TEXTURE_2D,d),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,!0),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,c),e(a),d}function k(a,b,c,d){var e=a.getUniformLocation(b,c);a.uniform1i(e,d)}function l(a,b,c,d,e){var f=a.getUniformLocation(b,c);a.uniform2f(f,d,e)}function m(a,b,c,d){var e=a,f=a+c,g=b,h=b+d;return[e,g,f,g,e,h,e,h,f,g,f,h]}function n(a,b,c,d){var f=a.createTexture();return a.activeTexture(a.TEXTURE0+b),a.bindTexture(a.TEXTURE_2D,f),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,c,d,0,a.RGBA,a.UNSIGNED_BYTE,null),e(a),f}function o(a,b,c,d){var f=n(a,b,c,d),g=a.getParameter(a.FRAMEBUFFER_BINDING),h=a.createFramebuffer();return a.bindFramebuffer(a.FRAMEBUFFER,h),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,f,0),e(a),{fbo:h,texture:f,oldFbo:g}}function p(a,b,c,d,f,g,j,n,p){var q=h(a,"#vsh-basic",g);a.useProgram(q),k(a,q,"u_image",b),l(a,q,"u_imageSize",c,d),l(a,q,"u_resolution",j,n),i(a,q,"a_texCoord",[0,0,1,0,0,1,0,1,1,0,1,1],{elementSize:2}),i(a,q,"a_position",p?m(0,n,j,-n):m(0,0,j,n),{elementSize:2}),a.viewport(0,0,j,n);var r=o(a,f,j,n);return a.viewport(0,0,j,n),a.drawArrays(a.TRIANGLES,0,6),a.bindFramebuffer(a.FRAMEBUFFER,r.oldFbo),e(a),r}function q(a,b,c){var d=a.naturalWidth||a.width,e=a.naturalHeight||a.height,f=b.canvas.width,g=b.canvas.height;b.viewport(0,0,f,g);var h=0;j(b,h,a);var i=2,k=3;p(b,h,d,e,i,"#fsh-lanczos-1d-covolve-horizontal",f,e,!1);var l=p(b,i,f,e,k,"#fsh-lanczos-1d-covolve-vertical",f,g,!0);b.flush();var m=b.createFramebuffer();b.bindFramebuffer(b.FRAMEBUFFER,m),b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,l.texture,0);var n=b.checkFramebufferStatus(b.FRAMEBUFFER);if(n!==b.FRAMEBUFFER_COMPLETE)throw new Error("Bad framebuffer status: "+n);c.alpha||(b.clearColor(1,1,1,1),b.colorMask(!1,!1,!1,!0),b.clear(b.COLOR_BUFFER_BIT));var o=new Uint8Array(f*g*4);b.readPixels(0,0,f,g,b.RGBA,b.UNSIGNED_BYTE,o);var q="undefined"==typeof c.unsharpAmount?0:0|c.unsharpAmount,s="undefined"==typeof c.unsharpRadius?0:c.unsharpRadius,t="undefined"==typeof c.unsharpThreshold?0:0|c.unsharpThreshold;return q&&r(o,f,g,q,s,t),o}var r=a("./js/unsharp"),s=a("./js/generate_id"),t={};t["#vsh-basic"]="precision highp float;\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform vec2 u_resolution;\n\nvarying vec2 v_texCoord;\n\nvoid main() {\n   vec2 clipSpace = a_position / u_resolution * 2.0 - 1.0;\n\n   gl_Position = vec4(clipSpace, 0, 1);\n   v_texCoord = a_texCoord;\n}\n",t["#fsh-lanczos-1d-covolve-horizontal"]="precision highp float;\nuniform vec2 u_resolution;\nuniform sampler2D u_image;\nuniform vec2 u_imageSize;\n\n#define winSize 3.0\n\nvarying vec2 v_texCoord;\n\n#define sinc(a) (sin(a)/a)\n#define M_PI 3.1415926535897932384626433832795\n\nvoid main() {\n  vec2 pixel = vec2(1.) / u_imageSize;\n  gl_FragColor = vec4(0.);\n\n  float total = 0.;\n  float scale = u_imageSize.x / u_resolution.x;\n  float count = winSize * scale * 2.;\n  for (int i = 0; i < 1024*8; i++) {\n    if (float(i) >= count) {\n      break;\n    }\n    float k = float(i) - (count / 2.);\n    vec2 offset = vec2(pixel.x * k, 0.);\n    vec4 c = texture2D(u_image, v_texCoord+offset);\n    float x = k / scale; // max [-3, 3]\n    float xpi = x * M_PI;\n    float b = sinc(xpi) * sinc(xpi / winSize);\n    if (x > -1.19209290E-07 && x < 1.19209290E-07) { \n      b = 1.;\n    }\n    total += b;\n    c *= vec4(b);\n    gl_FragColor += c;\n  }\n  gl_FragColor /= vec4(total);\n}\n",t["#fsh-lanczos-1d-covolve-vertical"]="precision highp float;\nuniform vec2 u_resolution;\nuniform sampler2D u_image;\nuniform vec2 u_imageSize;\n\n#define winSize 3.0\n\nvarying vec2 v_texCoord;\n\n#define sinc(a) (sin(a)/a)\n#define M_PI 3.1415926535897932384626433832795\n\nvoid main() {\n  vec2 pixel = vec2(1.) / u_imageSize;\n  gl_FragColor = vec4(0.);\n\n  float total = 0.;\n  float scale = u_imageSize.y / u_resolution.y;\n  float count = winSize * scale * 2.;\n  for (int i = 0; i < 1024*8; i++) {\n    if (float(i) >= count) {\n      break;\n    }\n    float k = float(i) - (count / 2.);\n    vec2 offset = vec2(0., pixel.y * k);\n    vec4 c = texture2D(u_image, v_texCoord+offset);\n    float x = k / scale; // max [-3, 3]\n    float xpi = x * M_PI;\n    float b = sinc(xpi) * sinc(xpi / winSize);\n    if (x > -1.19209290E-07 && x < 1.19209290E-07) { \n      b = 1.;\n    }\n    total += b;\n    c *= vec4(b);\n    gl_FragColor += c;\n  }\n  gl_FragColor /= vec4(total);\n}\n",b.exports=function(a,b,c,e){var g,h;try{h=document.createElement("canvas"),h.id="pica-webgl-temporarry-canvas",h.height=b.height,h.width=b.width,document.body.appendChild(h),g=f(h);var i=q(a,g,c);g.finish(),document.body.removeChild(h);var j=b.getContext("2d"),k=j.createImageData(b.width,b.height);k.data.set(i),j.putImageData(k,0,0),e(null,i)}catch(l){d(l),g.finish(),document.body.removeChild(h),e(l)}return s()},b.exports.terminate=function(){}},{"./js/generate_id":2,"./js/unsharp":5}],11:[function(a,b,c){function d(a){.5>a&&(a=.5);var b=Math.exp(.527076)/a,c=Math.exp(-b),d=Math.exp(-2*b),e=(1-c)*(1-c)/(1+2*b*c-d);return g=e,h=e*(b-1)*c,i=e*(b+1)*c,j=-e*d,k=2*c,l=-d,m=(g+h)/(1-k-l),n=(i+j)/(1-k-l),new Float32Array([g,h,i,j,k,l,m,n])}function e(a,b,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r,s,t;for(o=0;f>o;o++){for(l=o*e,m=o,n=0,g=a[l],k=g*d[6],j=k,q=d[0],r=d[1],s=d[4],t=d[5],p=0;e>p;p++)h=a[l],i=h*q+g*r+j*s+k*t,k=j,j=i,g=h,c[n]=j,n++,l++;for(l--,n--,m+=f*(e-1),g=a[l],k=g*d[7],j=k,h=g,q=d[2],r=d[3],p=e-1;p>=0;p--)i=h*q+g*r+j*s+k*t,k=j,j=i,g=h,h=a[l],b[m]=c[n]+j,l--,n--,m-=f}}function f(a,b,c,f){if(f){var g=new Uint16Array(a.length),h=new Float32Array(Math.max(b,c)),i=d(f);e(a,g,h,i,b,c,f),e(g,a,h,i,c,b,f)}}var g,h,i,j,k,l,m,n;b.exports=f},{}],12:[function(a,b,c){"use strict";function d(a){if(null===a||void 0===a)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(a)}var e=Object.prototype.hasOwnProperty,f=Object.prototype.propertyIsEnumerable;b.exports=Object.assign||function(a,b){for(var c,g,h=d(a),i=1;i<arguments.length;i++){c=Object(arguments[i]);for(var j in c)e.call(c,j)&&(h[j]=c[j]);if(Object.getOwnPropertySymbols){g=Object.getOwnPropertySymbols(c);for(var k=0;k<g.length;k++)f.call(c,g[k])&&(h[g[k]]=c[g[k]])}}return h}},{}],13:[function(a,b,c){var d=arguments[3],e=arguments[4],f=arguments[5],g=JSON.stringify;b.exports=function(a){for(var b,c=Object.keys(f),h=0,i=c.length;i>h;h++){var j=c[h];if(f[j].exports===a){b=j;break}}if(!b){b=Math.floor(Math.pow(16,8)*Math.random()).toString(16);for(var k={},h=0,i=c.length;i>h;h++){var j=c[h];k[j]=j}e[b]=[Function(["require","module","exports"],"("+a+")(self)"),k]}var l=Math.floor(Math.pow(16,8)*Math.random()).toString(16),m={};m[b]=b,e[l]=[Function(["require"],"require("+g(b)+")(self)"),m];var n="("+d+")({"+Object.keys(e).map(function(a){return g(a)+":["+e[a][0]+","+g(e[a][1])+"]"}).join(",")+"},{},["+g(l)+"])",o=window.URL||window.webkitURL||window.mozURL||window.msURL;return new Worker(o.createObjectURL(new Blob([n],{type:"text/javascript"})))}},{}],"/":[function(a,b,c){"use strict";function d(a){return Object.prototype.toString.call(a)}function e(a){return"[object Function]"===d(a)}function f(a,b,d,g){if(e(d)&&(g=d,d={}),isNaN(d)||(d={quality:d,alpha:!1}),m||(c.WEBGL=!1),m&&c.WEBGL){c.debug("Resize canvas with WebGL");var h=p(a,b,d,function(e){e?(c.debug("WebGL resize failed, do fallback and cancel next attempts"),c.debug(e),m=!1,f(a,b,s({},d,{_id:h}),g)):g()});return h}return i||(c.WW=!1),i&&c.WW?(c.debug("Resize buffer in WebWorker"),o(a,b,d,g)):(c.debug("Resize buffer sync (freeze event loop)"),n(a,b,d,g))}function g(a,b){var c={src:a.src,dest:a.dest,width:0|a.width,height:0|a.height,toWidth:0|a.toWidth,toHeight:0|a.toHeight,quality:a.quality,alpha:a.alpha,unsharpAmount:a.unsharpAmount,unsharpRadius:a.unsharpRadius,unsharpThreshold:a.unsharpThreshold};c.dest=q(c),c.unsharpAmount&&r(c.dest,c.toWidth,c.toHeight,c.unsharpAmount,c.unsharpRadius,c.unsharpThreshold),b(null,c.dest)}function h(a){n.terminate(a),o.terminate(a),p.terminate(a)}var i="undefined"!=typeof window&&"Worker"in window;if(i)try{var j=a("webworkify")(function(){});j.terminate()}catch(k){i=!1}var l,m=!1;try{"undefined"!=typeof document&&"undefined"!=typeof window&&window.WebGLRenderingContext&&(l=document.createElement("canvas"),(l.getContext("webgl")||l.getContext("experimental-webgl"))&&(m=!0))}catch(k){}finally{l=null}var n=a("./lib/resize_js"),o=a("./lib/resize_js_ww"),p=a("./lib/resize_webgl"),q=a("./lib/js/resize_array"),r=a("./lib/js/unsharp"),s=a("object-assign");c.resizeCanvas=f,c.resizeBuffer=g,c.terminate=h,c.WW=i,c.WEBGL=!1,c.debug=function(){}},{"./lib/js/resize_array":4,"./lib/js/unsharp":5,"./lib/resize_js":8,"./lib/resize_js_ww":9,"./lib/resize_webgl":10,"object-assign":12,webworkify:13}]},{},[])("/")}),!function(a){"use strict";function b(a){if(void 0===Function.prototype.name){var b=/function\s([^(]{1,})\(/,c=b.exec(a.toString());return c&&c.length>1?c[1].trim():""}return void 0===a.prototype?a.constructor.name:a.prototype.constructor.name}function c(a){return/true/.test(a)?!0:/false/.test(a)?!1:isNaN(1*a)?a:parseFloat(a)}function d(a){return a.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}var e="6.1.0",f={version:e,_plugins:{},_uuids:[],_activePlugins:{},rtl:function(){return"rtl"===a("html").attr("dir")},plugin:function(a,c){var e=c||b(a),f=d(e);this._plugins[f]=this[e]=a},registerPlugin:function(a,c){var e=c?d(c):b(a.constructor).toLowerCase();a.uuid=this.GetYoDigits(6,e),a.$element.attr("data-"+e)||a.$element.attr("data-"+e,a.uuid),a.$element.data("zfPlugin")||a.$element.data("zfPlugin",a),a.$element.trigger("init.zf."+e),this._uuids.push(a.uuid)},unregisterPlugin:function(a){var c=d(b(a.$element.data("zfPlugin").constructor));this._uuids.splice(this._uuids.indexOf(a.uuid),1),a.$element.removeAttr("data-"+c).removeData("zfPlugin").trigger("destroyed.zf."+c);for(var e in a)a[e]=null},reInit:function(b){var c=b instanceof a;try{if(c)b.each(function(){a(this).data("zfPlugin")._init()});else{var d=typeof b,e=this,f={object:function(b){b.forEach(function(b){a("[data-"+b+"]").foundation("_init")})},string:function(){a("[data-"+b+"]").foundation("_init")},undefined:function(){this.object(Object.keys(e._plugins))}};f[d](b)}}catch(g){console.error(g)}finally{return b}},GetYoDigits:function(a,b){return a=a||6,Math.round(Math.pow(36,a+1)-Math.random()*Math.pow(36,a)).toString(36).slice(1)+(b?"-"+b:"")},reflow:function(b,d){"undefined"==typeof d?d=Object.keys(this._plugins):"string"==typeof d&&(d=[d]);var e=this;a.each(d,function(d,f){var g=e._plugins[f],h=a(b).find("[data-"+f+"]").addBack("[data-"+f+"]");h.each(function(){var b=a(this),d={};if(b.data("zfPlugin"))return void console.warn("Tried to initialize "+f+" on an element that already has a Foundation plugin.");if(b.attr("data-options")){b.attr("data-options").split(";").forEach(function(a,b){var e=a.split(":").map(function(a){return a.trim()});e[0]&&(d[e[0]]=c(e[1]))})}try{b.data("zfPlugin",new g(a(this),d))}catch(e){console.error(e)}finally{return}})})},getFnName:b,transitionend:function(a){var b,c={transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"otransitionend"},d=document.createElement("div");for(var e in c)"undefined"!=typeof d.style[e]&&(b=c[e]);return b?b:(b=setTimeout(function(){a.triggerHandler("transitionend",[a])},1),"transitionend")}};f.util={throttle:function(a,b){var c=null;return function(){var d=this,e=arguments;null===c&&(c=setTimeout(function(){a.apply(d,e),c=null},b))}}};var g=function(c){var d=typeof c,e=a("meta.foundation-mq"),g=a(".no-js");if(e.length||a('<meta class="foundation-mq">').appendTo(document.head),g.length&&g.removeClass("no-js"),"undefined"===d)f.MediaQuery._init(),f.reflow(this);else{if("string"!==d)throw new TypeError("We're sorry, '"+d+"' is not a valid parameter. You must use a string representing the method you wish to invoke.");var h=Array.prototype.slice.call(arguments,1),i=this.data("zfPlugin");if(void 0===i||void 0===i[c])throw new ReferenceError("We're sorry, '"+c+"' is not an available method for "+(i?b(i):"this element")+".");1===this.length?i[c].apply(i,h):this.each(function(b,d){i[c].apply(a(d).data("zfPlugin"),h)})}return this};window.Foundation=f,a.fn.foundation=g,function(){Date.now&&window.Date.now||(window.Date.now=Date.now=function(){return(new Date).getTime()});for(var a=["webkit","moz"],b=0;b<a.length&&!window.requestAnimationFrame;++b){var c=a[b];window.requestAnimationFrame=window[c+"RequestAnimationFrame"],window.cancelAnimationFrame=window[c+"CancelAnimationFrame"]||window[c+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var d=0;window.requestAnimationFrame=function(a){var b=Date.now(),c=Math.max(d+16,b);return setTimeout(function(){a(d=c)},c-b)},window.cancelAnimationFrame=clearTimeout}window.performance&&window.performance.now||(window.performance={start:Date.now(),now:function(){return Date.now()-this.start}})}(),Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d?this:a,b.concat(Array.prototype.slice.call(arguments)))};return this.prototype&&(d.prototype=this.prototype),e.prototype=new d,e})}(jQuery),!function(a,b){"use strict";b.Keyboard={};var c={9:"TAB",13:"ENTER",27:"ESCAPE",32:"SPACE",37:"ARROW_LEFT",38:"ARROW_UP",39:"ARROW_RIGHT",40:"ARROW_DOWN"},d=function(a){var b={};for(var c in a)b[a[c]]=a[c];return b}(c);b.Keyboard.keys=d;var e=function(a){var b=c[a.which||a.keyCode]||String.fromCharCode(a.which).toUpperCase();return a.shiftKey&&(b="SHIFT_"+b),a.ctrlKey&&(b="CTRL_"+b),a.altKey&&(b="ALT_"+b),b};b.Keyboard.parseKey=e;var f={},g=function(c,d,g){var h,i,j,k=f[d],l=e(c);return k?(h="undefined"==typeof k.ltr?k:b.rtl()?a.extend({},k.ltr,k.rtl):a.extend({},k.rtl,k.ltr),i=h[l],j=g[i],void(j&&"function"==typeof j?(j.apply(),(g.handled||"function"==typeof g.handled)&&g.handled.apply()):(g.unhandled||"function"==typeof g.unhandled)&&g.unhandled.apply())):console.warn("Component not defined!")};b.Keyboard.handleKey=g;var h=function(b){return b.find("a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]").filter(function(){return a(this).is(":visible")&&!(a(this).attr("tabindex")<0)})};b.Keyboard.findFocusable=h;var i=function(a,b){f[a]=b};b.Keyboard.register=i}(jQuery,window.Foundation),!function(a,b){var c=function(a,b,c,e){var f,g,h,i,j=d(a);if(b){var k=d(b);g=j.offset.top+j.height<=k.height+k.offset.top,f=j.offset.top>=k.offset.top,h=j.offset.left>=k.offset.left,i=j.offset.left+j.width<=k.width}else g=j.offset.top+j.height<=j.windowDims.height+j.windowDims.offset.top,f=j.offset.top>=j.windowDims.offset.top,h=j.offset.left>=j.windowDims.offset.left,i=j.offset.left+j.width<=j.windowDims.width;var l=[g,f,h,i];return c?h===i==!0:e?f===g==!0:-1===l.indexOf(!1)},d=function(a,c){if(a=a.length?a[0]:a,a===b||a===document)throw new Error("I'm sorry, Dave. I'm afraid I can't do that.");var d=a.getBoundingClientRect(),e=a.parentNode.getBoundingClientRect(),f=document.body.getBoundingClientRect(),g=b.pageYOffset,h=b.pageXOffset;return{width:d.width,height:d.height,offset:{top:d.top+g,left:d.left+h},parentDims:{width:e.width,height:e.height,offset:{top:e.top+g,left:e.left+h}},windowDims:{width:f.width,height:f.height,offset:{top:g,left:h}}}},e=function(a,b,c,e,f,g){var h=d(a),i=b?d(b):null;switch(c){case"top":return{left:i.offset.left,top:i.offset.top-(h.height+e)};case"left":return{left:i.offset.left-(h.width+f),top:i.offset.top};case"right":return{left:i.offset.left+i.width+f,top:i.offset.top};case"center top":return{left:i.offset.left+i.width/2-h.width/2,top:i.offset.top-(h.height+e)};case"center bottom":return{left:g?f:i.offset.left+i.width/2-h.width/2,top:i.offset.top+i.height+e};case"center left":return{left:i.offset.left-(h.width+f),top:i.offset.top+i.height/2-h.height/2};case"center right":return{left:i.offset.left+i.width+f+1,top:i.offset.top+i.height/2-h.height/2};case"center":return{left:h.windowDims.offset.left+h.windowDims.width/2-h.width/2,top:h.windowDims.offset.top+h.windowDims.height/2-h.height/2};case"reveal":return{left:(h.windowDims.width-h.width)/2,top:h.windowDims.offset.top+e};case"reveal full":return{left:h.windowDims.offset.left,top:h.windowDims.offset.top};default:return{left:i.offset.left,top:i.offset.top+i.height+e}}};a.Box={ImNotTouchingYou:c,GetDimensions:d,GetOffsets:e}}(window.Foundation,window),!function(a,b){"use strict";b(document).on("click.zf.trigger","[data-open]",function(){var a=b(this).data("open");b("#"+a).triggerHandler("open.zf.trigger",[b(this)])}),b(document).on("click.zf.trigger","[data-close]",function(){var a=b(this).data("close");a?b("#"+a).triggerHandler("close.zf.trigger",[b(this)]):b(this).trigger("close.zf.trigger")}),b(document).on("click.zf.trigger","[data-toggle]",function(){var a=b(this).data("toggle");b("#"+a).triggerHandler("toggle.zf.trigger",[b(this)])}),b(document).on("close.zf.trigger","[data-closable]",function(){var c=b(this).data("closable")||"fade-out";a.Motion?a.Motion.animateOut(b(this),c,function(){b(this).trigger("closed.zf")}):b(this).fadeOut().trigger("closed.zf")});var c=function(){for(var a=["WebKit","Moz","O","Ms",""],b=0;b<a.length;b++)if(a[b]+"MutationObserver"in window)return window[a[b]+"MutationObserver"];return!1}(),d=function(){h(),f(),g(),e()};b(window).load(function(){d()});var e=function(a){var c=b("[data-yeti-box]"),d=["dropdown","tooltip","reveal"];if(a&&("string"==typeof a?d.push(a):"object"==typeof a&&"string"==typeof a[0]?d.concat(a):console.error("Plugin names must be strings")),c.length){var e=d.map(function(a){return"closeme.zf."+a}).join(" ");b(window).off(e).on(e,function(a,c){var d=a.namespace.split(".")[0],e=b("[data-"+d+"]").not('[data-yeti-box="'+c+'"]');e.each(function(){var a=b(this);a.triggerHandler("close.zf.trigger",[a])})})}},f=function(a){var d,e=b("[data-resize]");e.length&&b(window).off("resize.zf.trigger").on("resize.zf.trigger",function(f){d&&clearTimeout(d),d=setTimeout(function(){c||e.each(function(){b(this).triggerHandler("resizeme.zf.trigger")}),e.attr("data-events","resize")},a||10)})},g=function(a){var d,e=b("[data-scroll]");e.length&&b(window).off("scroll.zf.trigger").on("scroll.zf.trigger",function(f){d&&clearTimeout(d),d=setTimeout(function(){c||e.each(function(){b(this).triggerHandler("scrollme.zf.trigger")}),e.attr("data-events","scroll")},a||10)})},h=function(){if(!c)return!1;var a=document.querySelectorAll("[data-resize], [data-scroll], [data-mutate]"),d=function(a){var c=b(a[0].target);switch(c.attr("data-events")){case"resize":c.triggerHandler("resizeme.zf.trigger",[c]);break;case"scroll":c.triggerHandler("scrollme.zf.trigger",[c,window.pageYOffset]);break;default:return!1}};if(a.length)for(var e=0;e<=a.length-1;e++){var f=new c(d);f.observe(a[e],{attributes:!0,childList:!1,characterData:!1,subtree:!1,attributeFilter:["data-events"]})}};a.IHearYou=d}(window.Foundation,window.jQuery),!function(a,b){function c(a){var b={};return"string"!=typeof a?b:(a=a.trim().slice(1,-1))?b=a.split("&").reduce(function(a,b){var c=b.replace(/\+/g," ").split("="),d=c[0],e=c[1];return d=decodeURIComponent(d),e=void 0===e?null:decodeURIComponent(e),a.hasOwnProperty(d)?Array.isArray(a[d])?a[d].push(e):a[d]=[a[d],e]:a[d]=e,a},{}):b}var d={queries:[],current:"",atLeast:function(a){var b=this.get(a);return b?window.matchMedia(b).matches:!1},get:function(a){for(var b in this.queries){var c=this.queries[b];if(a===c.name)return c.value}return null},_init:function(){var b,d=this,e=a(".foundation-mq").css("font-family");b=c(e);for(var f in b)d.queries.push({name:f,value:"only screen and (min-width: "+b[f]+")"});this.current=this._getCurrentSize(),this._watcher()},_getCurrentSize:function(){var a;for(var b in this.queries){var c=this.queries[b];window.matchMedia(c.value).matches&&(a=c)}return"object"==typeof a?a.name:a},_watcher:function(){var b=this;a(window).on("resize.zf.mediaquery",function(){var c=b._getCurrentSize();c!==b.current&&(a(window).trigger("changed.zf.mediaquery",[c,b.current]),b.current=c)})}};b.MediaQuery=d,window.matchMedia||(window.matchMedia=function(){"use strict";var a=window.styleMedia||window.media;if(!a){var b=document.createElement("style"),c=document.getElementsByTagName("script")[0],d=null;b.type="text/css",b.id="matchmediajs-test",c.parentNode.insertBefore(b,c),d="getComputedStyle"in window&&window.getComputedStyle(b,null)||b.currentStyle,a={matchMedium:function(a){var c="@media "+a+"{ #matchmediajs-test { width: 1px; } }";return b.styleSheet?b.styleSheet.cssText=c:b.textContent=c,"1px"===d.width}}}return function(b){return{matches:a.matchMedium(b||"all"),media:b||"all"}}}())}(jQuery,Foundation),!function(a,b){function c(c,f,g,h){function i(){c||f.hide(),j(),h&&h.apply(f)}function j(){f[0].style.transitionDuration=0,f.removeClass(k+" "+l+" "+g)}if(f=a(f).eq(0),f.length){var k=c?d[0]:d[1],l=c?e[0]:e[1];j(),f.addClass(g).css("transition","none"),requestAnimationFrame(function(){f.addClass(k),c&&f.show()}),requestAnimationFrame(function(){f[0].offsetWidth,f.css("transition",""),f.addClass(l)}),f.one(b.transitionend(f),i)}}var d=["mui-enter","mui-leave"],e=["mui-enter-active","mui-leave-active"],f={animateIn:function(a,b,d){c(!0,a,b,d)},animateOut:function(a,b,d){c(!1,a,b,d)}},g=function(a,b,c){function d(h){g||(g=window.performance.now()),f=h-g,c.apply(b),a>f?e=window.requestAnimationFrame(d,b):(window.cancelAnimationFrame(e),b.trigger("finished.zf.animate",[b]).triggerHandler("finished.zf.animate",[b]))}var e,f,g=null;e=window.requestAnimationFrame(d)};b.Move=g,b.Motion=f}(jQuery,Foundation),!function(a,b){"use strict";function c(d,e){this.$element=d,this.options=b.extend({},c.defaults,this.$element.data(),e),this._init(),a.registerPlugin(this,"Reveal"),a.Keyboard.register("Reveal",{ENTER:"open",SPACE:"open",ESCAPE:"close",TAB:"tab_forward",SHIFT_TAB:"tab_backward"})}c.defaults={animationIn:"",animationOut:"",showDelay:0,hideDelay:0,closeOnClick:!0,closeOnEsc:!0,multipleOpened:!1,vOffset:100,hOffset:0,fullScreen:!1,btmOffsetPct:10,overlay:!0,resetOnClose:!1},c.prototype._init=function(){if(this.id=this.$element.attr("id"),this.isActive=!1,this.$anchor=b(b('[data-open="'+this.id+'"]').length?'[data-open="'+this.id+'"]':'[data-toggle="'+this.id+'"]'),this.$anchor.length){var c=this.$anchor[0].id||a.GetYoDigits(6,"reveal");this.$anchor.attr({"aria-controls":this.id,id:c,"aria-haspopup":!0,tabindex:0}),this.$element.attr({"aria-labelledby":c})}(this.options.fullScreen||this.$element.hasClass("full"))&&(this.options.fullScreen=!0,this.options.overlay=!1),this.options.overlay&&!this.$overlay&&(this.$overlay=this._makeOverlay(this.id)),this.$element.attr({role:"dialog","aria-hidden":!0,"data-yeti-box":this.id,"data-resize":this.id}),this._events()},c.prototype._makeOverlay=function(a){var c=b("<div></div>").addClass("reveal-overlay").attr({tabindex:-1,"aria-hidden":!0}).appendTo("body");return this.options.closeOnClick&&c.attr({"data-close":a}),c},c.prototype._events=function(){var a=this;this.$element.on({"open.zf.trigger":this.open.bind(this),"close.zf.trigger":this.close.bind(this),"toggle.zf.trigger":this.toggle.bind(this),"resizeme.zf.trigger":function(){a.$element.is(":visible")&&a._setPosition(function(){})}}),this.$anchor.length&&this.$anchor.on("keydown.zf.reveal",function(b){13!==b.which&&32!==b.which||(b.stopPropagation(),b.preventDefault(),a.open())}),this.options.closeOnClick&&this.options.overlay&&this.$overlay.off(".zf.reveal").on("click.zf.reveal",this.close.bind(this))},c.prototype._setPosition=function(b){var c=a.Box.GetDimensions(this.$element),d=this.options.fullScreen?"reveal full":c.height>=.5*c.windowDims.height?"reveal":"center";"reveal full"===d?this.$element.offset(a.Box.GetOffsets(this.$element,null,d,this.options.vOffset)).css({height:c.windowDims.height,width:c.windowDims.width}):a.MediaQuery.atLeast("medium")&&a.Box.ImNotTouchingYou(this.$element,null,!0,!1)?this.$element.css({"max-height":c.windowDims.height-this.options.vOffset*(this.options.btmOffsetPct/100+1),width:""}).offset(a.Box.GetOffsets(this.$element,null,d,this.options.vOffset)):(this.$element.css({width:c.windowDims.width-2*this.options.hOffset}).offset(a.Box.GetOffsets(this.$element,null,"center",this.options.vOffset,this.options.hOffset)),this.changedSize=!0),b()},c.prototype.open=function(){var c=this;this.isActive=!0,this.$element.css({visibility:"hidden"}).show().scrollTop(0),this._setPosition(function(){c.$element.hide().css({visibility:""}),c.options.multipleOpened||c.$element.trigger("closeme.zf.reveal",c.id),c.options.animationIn?c.options.overlay?a.Motion.animateIn(c.$overlay,"fade-in",function(){a.Motion.animateIn(c.$element,c.options.animationIn,function(){c.focusableElements=a.Keyboard.findFocusable(c.$element)})}):a.Motion.animateIn(c.$element,c.options.animationIn,function(){c.focusableElements=a.Keyboard.findFocusable(c.$element)}):c.options.overlay?c.$overlay.show(0,function(){c.$element.show(c.options.showDelay,function(){})}):c.$element.show(c.options.showDelay,function(){})}),this.$element.attr({"aria-hidden":!1}).attr("tabindex",-1).focus().trigger("open.zf.reveal"),b("body").addClass("is-reveal-open").attr({"aria-hidden":!(!this.options.overlay&&!this.options.fullScreen)}),setTimeout(function(){c._extraHandlers()},0)},c.prototype._extraHandlers=function(){var c=this;this.focusableElements=a.Keyboard.findFocusable(this.$element),this.options.overlay||!this.options.closeOnClick||this.options.fullScreen||b("body").on("click.zf.reveal",function(a){c.close()}),this.options.closeOnEsc&&b(window).on("keydown.zf.reveal",function(b){a.Keyboard.handleKey(b,"Reveal",{close:function(){c.options.closeOnEsc&&(c.close(),c.$anchor.focus())}}),0===c.focusableElements.length&&b.preventDefault()}),this.$element.on("keydown.zf.reveal",function(d){var e=b(this);a.Keyboard.handleKey(d,"Reveal",{tab_forward:function(){c.$element.find(":focus").is(c.focusableElements.eq(-1))&&(c.focusableElements.eq(0).focus(),d.preventDefault())},tab_backward:function(){(c.$element.find(":focus").is(c.focusableElements.eq(0))||c.$element.is(":focus"))&&(c.focusableElements.eq(-1).focus(),d.preventDefault())},open:function(){c.$element.find(":focus").is(c.$element.find("[data-close]"))?setTimeout(function(){c.$anchor.focus()},1):e.is(c.focusableElements)&&c.open()},close:function(){c.options.closeOnEsc&&(c.close(),c.$anchor.focus())}})})},c.prototype.close=function(){if(!this.isActive||!this.$element.is(":visible"))return!1;var c=this;this.options.animationOut?a.Motion.animateOut(this.$element,this.options.animationOut,function(){c.options.overlay&&a.Motion.animateOut(c.$overlay,"fade-out",function(){})}):this.$element.hide(c.options.hideDelay,function(){c.options.overlay&&c.$overlay.hide(0,function(){})}),this.options.closeOnEsc&&b(window).off("keydown.zf.reveal"),!this.options.overlay&&this.options.closeOnClick&&b("body").off("click.zf.reveal"),this.$element.off("keydown.zf.reveal"),this.changedSize&&this.$element.css({height:"",width:""}),b("body").removeClass("is-reveal-open").attr({"aria-hidden":!1,tabindex:""}),this.options.resetOnClose&&this.$element.html(this.$element.html()),this.isActive=!1,this.$element.attr({"aria-hidden":!0}).trigger("closed.zf.reveal")},c.prototype.toggle=function(){this.isActive?this.close():this.open()},c.prototype.destroy=function(){this.options.overlay&&this.$overlay.hide().off().remove(),this.$element.hide(),this.$anchor.off(),a.unregisterPlugin(this)},a.plugin(c,"Reveal"),"undefined"!=typeof module&&"undefined"!=typeof module.exports&&(module.exports=c),"function"==typeof define&&define(["foundation"],function(){return c})}(Foundation,jQuery),jQuery(function(a){a(document).ready(function(){a("input#wp-link-target").prop("checked",!0)})}),jQuery(document).ready(function(a){var b=a("#image-cropper");b.length>0&&(b.cropit({imageBackground:!0}),a(".rotate-cw").click(function(){a("#image-cropper").cropit("rotateCW")}),a(".rotate-ccw").click(function(){a("#image-cropper").cropit("rotateCCW")}),a(".cropit-select-image").click(function(){a(".cropit-image-input").click()}),a(".cropit-save-image").click(function(){var c=(a("#image-cropper").cropit("export",{type:"image/jpeg",quality:1,originalSize:!0}),b.cropit("imageSrc")),d=b.cropit("offset"),e=b.cropit("zoom"),f=b.cropit("previewSize"),g=(b.cropit("exportZoom"),new Image);g.src=c;var h=document.createElement("canvas");h.width=f.width/e,h.height=f.height/e;var i=h.getContext("2d");i.drawImage(g,d.x/e,d.y/e);var j=document.createElement("canvas");j.width=150,j.height=150,pica.resizeCanvas(h,j,{},function(b){if(b)return console.log(b);var c=j.toDataURL();a("#pyis-profile-image").removeAttr("srcset"),a("#pyis-profile-image").attr("src",c),a("#pyis_profile_image_data").val(c)})}))}),jQuery(function(a){a(document).foundation()}),jQuery(function(a){a(document).ready(function(){var b=a("#pyis-profile-edit-form");b[0].noValidate=!0,b.length>0&&b.submit(function(c){var d=!1;a(".pyis-error-message").hide();var e=0;return a(".pyis-name-error-hint").html("").hide(),a("input.name-field").each(function(b,c){a(c).removeClass("validation-error"),0==a(c).val().length&&(a(c).addClass("validation-error"),a(c).prevAll(".pyis-name-error-hint:first-of-type").html("Please fill out this field.<br />").show(),e++)}),a(".pyis-validate-url").each(function(b,c){if(a(c).removeClass("validation-error"),a(c)[0].setCustomValidity(""),a(c).next(".pyis-error-hint").html(""),a(c).val().length>0&&-1==a(c).val().indexOf(a(c).data("validate"))){
a(c).addClass("validation-error");var d='Your entry must contain "'+a(c).data("validate")+'"';a(c)[0].setCustomValidity(d),a(c).next(".pyis-error-hint").html(d),e++}}),b[0].reportValidity(),0==e?d=!0:a(".pyis-error-message").show(),d})})});
//# sourceMappingURL=script.js.map